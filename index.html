<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MANAGER OF SALES : 스카우팅 리포트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        :root {
            --fm-bg: #1e1e24;       /* Deep Grey/Black */
            --fm-sidebar: #2b2b36;  /* Sidebar Grey */
            --fm-accent: #8b5cf6;   /* FM Purple */
            --fm-text: #e2e8f0;     /* White/Grey Text */
            --fm-green: #10b981;    /* Attribute Green */
            --fm-red: #ef4444;      /* Alert Red */
            --fm-blue: #3b82f6;     /* Button Blue */
            --fm-gold: #f59e0b;     /* Star Rating Gold */
        }

        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #111;
            color: var(--fm-text);
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overscroll-behavior: none;
        }

        /* Main Game Container */
        .fm-frame {
            width: 100%;
            max-width: 480px;
            height: 100dvh; /* Mobile viewport fix */
            max-height: 900px;
            background-color: var(--fm-bg);
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            overflow: hidden;
        }

        /* Top Header */
        .fm-header {
            background-color: var(--fm-sidebar);
            border-bottom: 1px solid #444;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 20;
            flex-shrink: 0;
        }
        .header-title {
            font-weight: 800;
            font-size: 15px;
            letter-spacing: 0.5px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .header-date {
            font-size: 12px;
            color: #9ca3af;
            background: rgba(255,255,255,0.1);
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* Main Scene Content */
        .scene {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            padding-bottom: 100px; /* Space for message box */
            overflow-y: auto;
            position: relative;
            scrollbar-width: thin;
            scrollbar-color: #555 #222;
        }
        .scene.center-content { justify-content: center; }

        /* Intro Screen */
        .intro-screen {
            text-align: center;
            width: 100%;
        }
        .intro-logo {
            font-size: 32px;
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 10px;
            background: linear-gradient(to right, #fff, #999);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .intro-sub {
            color: var(--fm-accent);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 40px;
            letter-spacing: 1px;
        }
        .start-btn {
            background: var(--fm-red);
            color: white;
            font-weight: 700;
            padding: 14px 40px;
            border-radius: 4px;
            font-size: 16px;
            transition: all 0.2s;
            box-shadow: 0 4px 0 #991b1b;
        }
        .start-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* Menus */
        .menu-wrapper {
            width: 100%;
            display: none;
            flex-direction: column;
            gap: 12px;
            animation: fadeIn 0.3s ease-out;
        }
        .menu-wrapper.active { display: flex; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* FM Box Style */
        .fm-box {
            background: #2b2b36;
            border: 1px solid #444;
            border-radius: 6px;
            padding: 0;
            margin-bottom: 10px;
            overflow: hidden;
        }
        .fm-box-header {
            background: #363642;
            padding: 10px 15px;
            border-bottom: 1px solid #444;
            font-size: 13px;
            font-weight: 700;
            color: #d1d5db;
            text-transform: uppercase;
            display: flex;
            justify-content: space-between;
        }
        .fm-box-content {
            padding: 15px;
        }

        /* Position Selection Cards */
        .pos-card {
            background: #373745;
            border: 1px solid #4b5563;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: 0.15s;
        }
        .pos-card:hover, .pos-card.active {
            background: #4b5563;
            border-color: var(--fm-green);
        }
        .pos-icon {
            width: 36px; height: 36px;
            border-radius: 50%;
            background: #1f2937;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-weight: bold;
            font-size: 12px;
            border: 2px solid #555;
        }
        .pos-fw { border-color: #ef4444; color: #ef4444; }
        .pos-mf { border-color: #3b82f6; color: #3b82f6; }
        .pos-df { border-color: #10b981; color: #10b981; }
        .pos-mgr { border-color: #f59e0b; color: #f59e0b; }
        .pos-info h4 { font-size: 14px; font-weight: 700; color: #fff; margin-bottom: 2px; }
        .pos-info p { font-size: 11px; color: #9ca3af; }

        /* Buttons */
        .fm-btn {
            display: block;
            width: 100%;
            background: #373745;
            color: #fff;
            border: 1px solid #555;
            padding: 12px;
            text-align: left;
            font-size: 14px;
            border-radius: 4px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: 0.1s;
        }
        .fm-btn:hover, .fm-btn.active {
            background: #4b5563;
            border-color: var(--fm-green);
            color: #fff;
        }
        .fm-btn-back {
            background: transparent;
            color: #9ca3af;
            padding: 10px;
            text-align: center;
            font-size: 13px;
            border: 1px solid #444;
            border-radius: 4px;
        }
        .fm-btn-confirm {
            background: var(--fm-red);
            color: #fff;
            font-weight: 700;
            padding: 12px;
            text-align: center;
            border-radius: 4px;
            border: none;
            box-shadow: 0 2px 0 #991b1b;
        }
        .fm-btn-confirm:active { transform: translateY(2px); box-shadow: none; }

        /* Inputs */
        .fm-label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #9ca3af;
            margin-bottom: 6px;
        }
        .fm-input {
            width: 100%;
            background: #1f1f24;
            border: 1px solid #444;
            color: #fff;
            padding: 12px;
            font-size: 16px;
            border-radius: 4px;
            outline: none;
            transition: 0.2s;
        }
        .fm-input:focus { border-color: var(--fm-accent); background: #25252b; }
        .fm-input::placeholder { color: #555; font-style: italic; }

        /* Gender Select */
        .gender-grid { display: flex; gap: 8px; margin-bottom: 12px; }
        .gender-opt { 
            flex: 1; padding: 10px; background: #25252b; border: 1px solid #444; 
            text-align: center; border-radius: 4px; cursor: pointer; color: #9ca3af; font-size: 13px;
        }
        .gender-opt.active { border-color: var(--fm-accent); color: #fff; background: #373745; }

        /* Message Box (Compact) */
        .message-box {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            height: 70px;
            background: rgba(30, 30, 36, 0.95);
            border-top: 1px solid #444;
            padding: 8px 16px;
            z-index: 50;
            display: flex;
            align-items: center;
            backdrop-filter: blur(5px);
            transition: transform 0.3s ease;
        }
        /* Hide when keyboard active logic */
        .message-box.hidden-kb { transform: translateY(100%); }

        .msg-avatar {
            width: 36px; height: 36px;
            background: #555;
            border-radius: 50%;
            margin-right: 12px;
            overflow: hidden;
            border: 2px solid #777;
            flex-shrink: 0;
        }
        .msg-content { flex: 1; }
        .msg-name { font-size: 10px; font-weight: 700; color: var(--fm-green); margin-bottom: 2px; text-transform: uppercase; }
        .msg-text { font-size: 12px; line-height: 1.3; color: #e2e8f0; }

        /* Result Styles */
        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .res-photo {
            width: 60px; height: 60px;
            background: #ccc;
            margin-right: 15px;
            border: 1px solid #fff;
            object-fit: cover;
        }
        .res-info h2 { font-size: 20px; font-weight: 800; color: #fff; margin-bottom: 2px; }
        .res-info p { font-size: 13px; color: var(--fm-green); font-weight: 600; text-transform: uppercase; }
        
        .stat-table { width: 100%; font-size: 13px; border-collapse: collapse; }
        .stat-table td { padding: 6px 0; border-bottom: 1px solid #333; }
        .stat-label { color: #9ca3af; }
        .stat-val { text-align: right; font-weight: 700; color: #fff; }
        
        .val-box {
            background: #374151;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            margin: 15px 0;
            border-left: 4px solid var(--fm-gold);
        }
        .val-label { font-size: 11px; color: #9ca3af; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px; }
        .val-amount { font-size: 28px; font-weight: 800; color: #fff; }
        .val-sub { font-size: 12px; color: #d1d5db; font-weight: 500; }

        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>

<div class="fm-frame">
    
    <!-- Header -->
    <div class="fm-header">
        <div class="header-title">
            <i class="ph-fill ph-trophy text-lg text-yellow-400"></i> MANAGER OF SALES
        </div>
        <div class="header-date" id="currentDate">2026.01.05</div>
    </div>

    <!-- Scene -->
    <div class="scene center-content" id="main-scene">
        
        <!-- Intro -->
        <div id="intro-screen" class="intro-screen">
            <div class="mb-8 flex justify-center">
                <div class="w-24 h-24 bg-gradient-to-br from-gray-700 to-gray-900 rounded-full flex items-center justify-center border-4 border-gray-600 shadow-2xl relative">
                    <i class="ph-duotone ph-soccer-ball text-5xl text-white opacity-90"></i>
                    <div class="absolute -bottom-2 bg-green-600 text-white text-[10px] font-bold px-2 py-0.5 rounded">SCOUT</div>
                </div>
            </div>
            <h1 class="intro-logo">SCOUTING<br>REPORT 2026</h1>
            <p class="intro-sub">FA MARKET VALUE ANALYSIS</p>
            
            <div class="bg-gray-800/80 p-4 rounded-lg mb-8 text-xs text-gray-400 max-w-xs mx-auto border border-gray-700 leading-relaxed">
                실제 이적 시장 데이터를 기반으로<br>
                귀하의 <strong>잠재적 이적료</strong>를 정밀 산출합니다.
            </div>

            <button class="start-btn" onclick="goToStep(0)">
                분석 시작하기
            </button>
        </div>

        <!-- 1. Position Select -->
        <div id="step-position" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header">
                    <span>Select Position</span> <span class="text-xs text-gray-500">1/15</span>
                </div>
                <div class="fm-box-content p-2">
                    <div id="pos-list"></div>
                </div>
            </div>
        </div>

        <!-- 2. Rank -->
        <div id="step-rank" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Current Status (직급)</span> <span>2/15</span></div>
                <div class="fm-box-content">
                    <div id="rank-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>
        
        <!-- 3. Team Size -->
        <div id="step-team" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Staff Management (조직)</span> <span>3/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label">본인 산하 조직원 수 (명)</label>
                    <input type="number" id="team_size" class="fm-input" placeholder="0" onfocus="hideMsg()" onblur="showMsg()">
                    <p class="text-xs text-gray-500 mt-2" id="team-hint">
                        * 팀원: 0명 / 팀장: 1~5명 / 지점장: 6~20명 / 본부장: 21명+
                    </p>
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" onclick="submitInput('team')">확인</button>
            </div>
        </div>

        <!-- 4. License [NEW] -->
        <div id="step-license" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Skill Attributes (자격)</span> <span>4/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">보유 자격증 범위</label>
                    <div id="license-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 5. Career -->
        <div id="step-career" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Experience (경력)</span> <span>5/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label">총 영업 경력 (년)</label>
                    <input type="number" id="career" class="fm-input" placeholder="예: 3" onfocus="hideMsg()" onblur="showMsg()">
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" onclick="submitInput('career')">확인</button>
            </div>
        </div>

        <!-- 6. Income -->
        <div id="step-income" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Previous Wage (연봉)</span> <span>6/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label">직전연도 원천징수 금액 (만원)</label>
                    <input type="number" id="income" class="fm-input" placeholder="예: 6000" onfocus="hideMsg()" onblur="showMsg()">
                    <p class="text-xs text-gray-500 mt-2">* 세전 기준, 보너스 포함</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" onclick="submitInput('income')">확인</button>
            </div>
        </div>

        <!-- 7. History -->
        <div id="step-history" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Transfer History (이적)</span> <span>7/15</span></div>
                <div class="fm-box-content">
                    <p class="text-xs text-red-500 font-bold mb-3">⚠ 최근 3년 이내 이직 횟수</p>
                    <div id="history-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 8. Sales Style -->
        <div id="step-style" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Tactical Style (전술 성향)</span> <span>8/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">주력 영업 방식</label>
                    <div id="style-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 9. Target Client [NEW] -->
        <div id="step-client" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Target Market (고객)</span> <span>9/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">주력 고객 연령대/유형</label>
                    <div id="client-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 10. Portfolio -->
        <div id="step-portfolio" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Preferred Moves (상품)</span> <span>10/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">주력 판매 상품군</label>
                    <div id="portfolio-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 11. W Score -->
        <div id="step-w" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Consistency (꾸준함)</span> <span>11/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">주간 연속 청약(W) 달성 기록</label>
                    <div id="w-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 12. Performance -->
        <div id="step-perf" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Season Stats (실적)</span> <span>12/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label">월 평균 건수</label>
                    <input type="number" id="count" class="fm-input mb-4" placeholder="예: 4.5" onfocus="hideMsg()" onblur="showMsg()">
                    
                    <label class="fm-label">월 평균 환산/초회 보험료 (만원)</label>
                    <input type="number" id="premium" class="fm-input" placeholder="예: 50" onfocus="hideMsg()" onblur="showMsg()">
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" onclick="submitInput('perf')">확인</button>
            </div>
        </div>

        <!-- 13. MDRT & Quality -->
        <div id="step-qual" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Quality & Honor</span> <span>13/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">MDRT 달성 경험 (최근 2년)</label>
                    <div id="mdrt-options" class="mb-4"></div>
                    
                    <label class="fm-label mt-4">13회차 유지율 (%)</label>
                    <input type="number" id="p13" class="fm-input mb-4" placeholder="예: 95" onfocus="hideMsg()" onblur="showMsg()">
                    
                    <label class="fm-label">25회차 유지율 (%)</label>
                    <input type="number" id="p25" class="fm-input" placeholder="예: 85" onfocus="hideMsg()" onblur="showMsg()">
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" onclick="submitInput('qual')">확인</button>
            </div>
        </div>

        <!-- 14. Priority [NEW] -->
        <div id="step-needs" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Contract Priority (우선순위)</span> <span>14/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label mb-2">이직 시 최우선 고려 사항</label>
                    <div id="needs-options"></div>
                </div>
            </div>
            <button class="fm-btn-back w-full" onclick="prevStep()">이전 단계</button>
        </div>

        <!-- 15. Info & Contact -->
        <div id="step-info" class="menu-wrapper">
            <div class="fm-box">
                <div class="fm-box-header"><span>Player Registration</span> <span>15/15</span></div>
                <div class="fm-box-content">
                    <label class="fm-label">이름 (실명)</label>
                    <input type="text" id="userName" class="fm-input mb-3" placeholder="홍길동" onfocus="hideMsg()" onblur="showMsg()">
                    
                    <div class="gender-grid mb-3">
                        <div class="gender-opt" onclick="selectGender('M', this)">남성</div>
                        <div class="gender-opt" onclick="selectGender('F', this)">여성</div>
                    </div>
                    <input type="hidden" id="gender">

                    <label class="fm-label">출생연도</label>
                    <input type="number" id="birthYear" class="fm-input mb-3" placeholder="1990" onfocus="hideMsg()" onblur="showMsg()">
                    
                    <label class="fm-label">활동 지역</label>
                    <input type="text" id="region" class="fm-input mb-3" placeholder="서울 강남" onfocus="hideMsg()" onblur="showMsg()">

                    <label class="fm-label">연락처</label>
                    <div class="flex gap-2">
                        <input type="text" value="010" readonly class="fm-input w-1/4 text-gray-500 bg-gray-800 text-center">
                        <input type="tel" id="p_mid" class="fm-input w-1/3 text-center" maxlength="4" placeholder="1234" onfocus="hideMsg()" onblur="showMsg()">
                        <input type="tel" id="p_end" class="fm-input w-1/3 text-center" maxlength="4" placeholder="5678" onfocus="hideMsg()" onblur="showMsg()">
                    </div>
                </div>
            </div>
            <div class="flex gap-2">
                <button class="fm-btn-back flex-1" onclick="prevStep()">이전</button>
                <button class="fm-btn-confirm flex-1" style="background:#10b981;" onclick="submitInput('info_contact')">리포트 생성</button>
            </div>
        </div>

        <!-- Result -->
        <div id="step-result" class="menu-wrapper" style="max-width: 95%;">
            <div class="fm-box">
                <div class="fm-box-header">
                    <span>SCOUTING REPORT</span>
                    <span class="text-xs font-normal text-gray-400" id="res-date">2026.01.05</span>
                </div>
                <div class="fm-box-content">
                    
                    <div class="result-header">
                        <img id="res-img" src="" class="res-photo object-cover rounded">
                        <div class="res-info">
                            <h2 id="res-name">NAME</h2>
                            <p id="res-role">POSITION</p>
                            <span class="text-xs text-gray-400" id="res-rank-txt">RANK</span>
                        </div>
                    </div>

                    <div class="val-box">
                        <p class="val-label">ESTIMATED TRANSFER FEE (이적료)</p>
                        <div class="val-amount">
                            <span id="finalPrice">0</span> <span class="text-lg font-normal text-gray-400">만원</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1 val-sub">연봉 대비 <span id="finalPct" class="text-green-500 font-bold">0</span>% 가치</p>
                    </div>

                    <table class="stat-table mb-4">
                        <tr>
                            <td class="stat-label">Potential (잠재력)</td>
                            <td class="stat-val text-yellow-400">⭐⭐⭐⭐⭐</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Productivity (생산성)</td>
                            <td class="stat-val" id="res-prod">A</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Consistency (유지율)</td>
                            <td class="stat-val" id="res-qual">A</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Style (스타일)</td>
                            <td class="stat-val text-blue-400" id="res-style">---</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Specialty (특기)</td>
                            <td class="stat-val" id="res-specialty">---</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Honor (MDRT)</td>
                            <td class="stat-val" id="res-honor">None</td>
                        </tr>
                    </table>

                    <div class="bg-gray-800 p-3 rounded text-xs leading-relaxed text-gray-300 border-l-2 border-purple-500">
                        <strong class="block text-purple-400 mb-1">SCOUT OPINION</strong>
                        <span id="aiAdvice">...</span>
                    </div>

                </div>
            </div>
            
            <div class="flex gap-2">
                <button class="fm-btn text-center text-sm" onclick="location.reload()">새로고침</button>
                <button class="fm-btn text-center text-sm bg-blue-600 border-blue-500" onclick="alert('복사되었습니다.')">리포트 공유</button>
            </div>
        </div>

    </div>

    <!-- Manager Message Box (Compact) -->
    <div class="message-box" id="msg-box" style="display:none;">
        <div class="msg-avatar">
            <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Manager&clothing=blazerAndShirt&accessories=glasses" class="w-full h-full">
        </div>
        <div class="msg-content">
            <div class="msg-name">Chief Scout</div>
            <div class="msg-text" id="npc-text"></div>
        </div>
    </div>

</div>

<script>
    // --- Data ---
    const positions = [
        { id: 'mf', name: '미드필더 (MF)', desc: '꾸준한 세일즈맨 - 기초가 탄탄한 영업자', icon: 'M', color: 'pos-mf' },
        { id: 'fw', name: '스트라이커 (FW)', desc: '클로징 마스터 - 골 결정력이 좋음', icon: 'S', color: 'pos-fw' },
        { id: 'df', name: '수비수 (DF)', desc: 'TA 고수 - 연결을 잘해줌', icon: 'D', color: 'pos-df' },
        { id: 'mgr', name: '감독 (Manager)', desc: '훌륭한 조직 매니저', icon: 'M', color: 'pos-mgr' },
        { id: 'coach', name: '코칭스태프 (Coach)', desc: '리더의 훌륭한 조력자', icon: 'C', color: 'pos-mgr' }
    ];

    const ranks = [
        { l: '팀원 (FA/FC)', v: 'member' },
        { l: '팀장 (SM/FM)', v: 'team_leader' },
        { l: '지점장 (BM)', v: 'branch_manager' },
        { l: '본부장/임원', v: 'director' }
    ];

    const historyOpts = [
        { l: '이직 없음 (Stable)', v: 0 },
        { l: '1회 (Normal)', v: 1 },
        { l: '2회 (Frequent)', v: 2 },
        { l: '3회 이상 (High Risk)', v: 3 }
    ];

    const wOpts = [
        { l: '없음', v: 0 },
        { l: '1W (10주 이상)', v: 0.03 },
        { l: '1W (20주 이상)', v: 0.05 },
        { l: '2W (50주 이상)', v: 0.10 },
        { l: '3W (50주 이상)', v: 0.15 }
    ];

    const styleOpts = [
        { l: '개척 영업 (Sourcing)', v: '개척' },
        { l: '지인/소개 (Referral)', v: '지인' },
        { l: 'DB 영업 (Inbound)', v: 'DB' }
    ];

    const portOpts = [
        { l: '보장성 (Protection)', v: '보장' },
        { l: '저축성 (Savings)', v: '저축' },
        { l: '자동차/화재 (General)', v: '손해' }
    ];

    const mdrtOpts = [
        { l: '해당 없음', v: 0 },
        { l: 'MDRT', v: 0.1 },
        { l: 'COT', v: 0.15 },
        { l: 'TOT', v: 0.2 }
    ];
    
    // New Options
    const licenseOpts = [
        { l: '생/손보 공통 자격', v: 0 },
        { l: '+ 변액 보험 자격', v: 0.05 },
        { l: '+ 투자권유 대행인', v: 0.1 }
    ];
    
    const clientOpts = [
        { l: '직장인/2030', v: 'salary' },
        { l: '주부/4050', v: 'homemaker' },
        { l: '자영업자/소상공인', v: 'biz' },
        { l: '법인/CEO/전문직', v: 'vip' }
    ];
    
    const needsOpts = [
        { l: 'DB 제공 및 질', v: 'db' },
        { l: '수수료 (보너스)', v: 'pay' },
        { l: '교육 시스템', v: 'edu' },
        { l: '관리자 비전', v: 'vision' }
    ];

    let userData = {};
    let currentStep = -1; 

    // --- Init ---
    window.onload = function() {
        const today = new Date();
        document.getElementById('currentDate').innerText = `${today.getFullYear()}.${today.getMonth()+1}.${today.getDate()}`;
    };

    // --- Core Functions ---
    function typeText(text) {
        const el = document.getElementById('npc-text');
        el.innerHTML = '';
        let i = 0;
        function type() {
            if (i < text.length) {
                el.innerHTML += text.charAt(i);
                i++;
                setTimeout(type, 15);
            } else {
                el.innerHTML += '<span class="blink-cursor"></span>';
            }
        }
        type();
    }

    function showStepScreen(stepId) {
        document.querySelectorAll('.menu-wrapper').forEach(el => el.classList.remove('active'));
        document.getElementById('intro-screen').style.display = 'none';
        const scene = document.getElementById('main-scene');
        scene.classList.remove('center-content');
        
        if(stepId) {
            document.getElementById(stepId).classList.add('active');
            
            // Show Msg Box by default
            document.getElementById('msg-box').style.display = 'flex';
            
            let msg = "";
            switch(stepId) {
                case 'step-position': msg = "자신의 성향과 가장 잘 맞는 포지션을 선택하세요."; scene.classList.add('center-content'); break;
                case 'step-rank': msg = "현재 소속된 팀에서의 직급은 무엇입니까?"; break;
                case 'step-team': msg = "본인이 직접 관리하는 산하 조직원 수를 정확히 입력하세요."; break;
                case 'step-license': msg = "보유하고 계신 보험 자격증의 범위를 선택해주세요."; break;
                case 'step-career': msg = "총 영업 경력(개월/년)을 입력해주세요."; break;
                case 'step-income': msg = "중요합니다. 작년 원천징수 영수증 기준 연봉은 얼마인가요?"; break;
                case 'step-history': msg = "최근 3년 이내 이직 횟수를 솔직하게 선택해주세요."; break;
                case 'step-style': msg = "주로 어떤 방식으로 영업을 전개하시나요? (전술 성향)"; break;
                case 'step-client': msg = "주력으로 만나는 고객층(타겟)은 누구입니까?"; break;
                case 'step-portfolio': msg = "가장 자신 있는 주력 상품군은 무엇입니까? (선호 플레이)"; break;
                case 'step-w': msg = "주간 연속 청약(W) 달성 경험이 있다면 선택해주세요."; break;
                case 'step-perf': msg = "월 평균 실적(건수, 보험료)을 입력하세요."; break;
                case 'step-mdrt': msg = "명예의 전당(MDRT) 달성 이력이 있나요?"; break;
                case 'step-qual': msg = "계약 건전성 지표(유지율)를 확인합니다."; break;
                case 'step-needs': msg = "이직 시 가장 중요하게 생각하는 조건은 무엇입니까?"; break;
                case 'step-info': msg = "리포트 발급을 위한 본인 정보를 입력해주세요."; break;
                case 'step-result': 
                    document.getElementById('msg-box').style.display = 'none'; 
                    scene.classList.add('center-content');
                    break;
            }
            if(msg) typeText(msg);
        }
    }

    // Hide/Show Msg Box on Input Focus
    function hideMsg() { document.getElementById('msg-box').style.display = 'none'; }
    function showMsg() { document.getElementById('msg-box').style.display = 'flex'; }

    // --- Logic ---
    function goToStep(stepIdx) {
        currentStep = stepIdx;
        const stepIds = [
            'step-position', 'step-rank', 'step-team', 'step-license', 'step-career', 'step-income', 
            'step-history', 'step-style', 'step-client', 'step-portfolio', 'step-w', 'step-perf', 
            'step-mdrt', 'step-qual', 'step-needs', 'step-info', 'step-result'
        ];
        
        // Dynamic Render
        if (stepIdx === 0) { // Position
            const list = document.getElementById('pos-list');
            list.innerHTML = '';
            positions.forEach(p => {
                const el = document.createElement('div');
                el.className = 'pos-card';
                el.innerHTML = `
                    <div class="pos-icon ${p.color}">${p.icon}</div>
                    <div class="pos-info">
                        <h4>${p.name}</h4>
                        <p>${p.desc}</p>
                    </div>
                `;
                el.onclick = () => { userData['position'] = p; nextStep(); };
                list.appendChild(el);
            });
        }
        else if (stepIdx === 1) renderButtons('rank-options', ranks, 'rank');
        else if (stepIdx === 3) renderButtons('license-options', licenseOpts, 'license');
        else if (stepIdx === 6) renderButtons('history-options', historyOpts, 'job_hop');
        else if (stepIdx === 7) renderButtons('style-options', styleOpts, 'sales_style');
        else if (stepIdx === 8) renderButtons('client-options', clientOpts, 'client');
        else if (stepIdx === 9) renderButtons('portfolio-options', portOpts, 'portfolio');
        else if (stepIdx === 10) renderButtons('w-options', wOpts, 'w_score');
        else if (stepIdx === 12) renderButtons('mdrt-options', mdrtOpts, 'mdrt');
        else if (stepIdx === 14) renderButtons('needs-options', needsOpts, 'needs');

        showStepScreen(stepIds[stepIdx]);
    }

    function renderButtons(containerId, options, key) {
        const list = document.getElementById(containerId);
        list.innerHTML = '';
        options.forEach(o => {
            const btn = document.createElement('button');
            btn.className = 'fm-btn';
            btn.innerText = o.l;
            btn.onclick = () => { userData[key] = o.v; nextStep(); };
            list.appendChild(btn);
        });
    }

    function selectGender(val, el) {
        document.querySelectorAll('.gender-opt').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        userData['gender'] = val;
    }

    function nextStep() {
        goToStep(currentStep + 1);
    }

    function prevStep() {
        if(currentStep > 0) goToStep(currentStep - 1);
        else location.reload();
    }

    function submitInput(type) {
        let valid = true;
        if(type === 'team') {
            const v = document.getElementById('team_size').value;
            if(v === '') valid=false; else userData['team_size'] = parseInt(v);
        }
        else if(type === 'career') {
            const v = document.getElementById('career').value;
            if(!v) valid=false; else userData['career'] = parseFloat(v);
        }
        else if(type === 'income') {
            const v = document.getElementById('income').value;
            if(!v) valid=false; else userData['income'] = parseInt(v);
        }
        else if(type === 'perf') {
            const c = document.getElementById('count').value;
            const p = document.getElementById('premium').value;
            if(!c || !p) valid=false; 
            else { userData['count']=parseFloat(c); userData['premium']=parseInt(p); }
        }
        else if(type === 'qual') {
            const p13 = document.getElementById('p13').value;
            const p25 = document.getElementById('p25').value;
            if(!p13 || !p25) valid=false;
            else { userData['p13']=parseInt(p13); userData['p25']=parseInt(p25); }
        }
        else if(type === 'info_contact') {
            const n = document.getElementById('userName').value;
            const b = document.getElementById('birthYear').value;
            const r = document.getElementById('region').value;
            const m = document.getElementById('p_mid').value;
            const e = document.getElementById('p_end').value;
            const g = userData['gender'];
            
            if(!n || !b || !r || !g || !m || !e || m.length<4 || e.length<4) valid=false;
            else { 
                userData['name']=n; userData['birth']=b; userData['region']=r; 
                userData['phone'] = `010-${m}-${e}`;
                finishGame();
                return;
            }
        }

        if(!valid) {
            alert('정보를 정확히 입력해주세요.');
            return;
        }
        nextStep();
    }

    function finishGame() {
        const income = userData['income'] || 0;
        let mult = 1.0;
        
        // Multiplier Logic
        if(userData['job_hop'] === 0) mult += 0.1;
        if(userData['job_hop'] >= 3) mult -= 0.2;
        if(userData['p13'] >= 95) mult += 0.1;
        if(userData['w_score']) mult += userData['w_score'];
        if(userData['mdrt']) mult += userData['mdrt'];
        if(userData['license']) mult += userData['license'];
        
        let final = Math.round(income * mult * 0.5); 
        let pct = Math.round((final/income)*100);
        
        showStepScreen('step-result');
        
        const genderSeed = userData['gender'] === 'M' ? 'Felix' : 'Aneka';
        document.getElementById('res-img').src = `https://api.dicebear.com/9.x/avataaars/svg?seed=${genderSeed}&clothing=blazerAndShirt&accessories=glasses&backgroundColor=1f2937`;
        document.getElementById('res-name').innerText = userData['name'];
        document.getElementById('res-role').innerText = userData['position'].name.split('(')[0].trim();
        
        const rMap = {'member':'1군 선수 (팀원)', 'team_leader':'주장 (팀장)', 'branch_manager':'코치 (지점장)', 'director':'감독 (본부장)'};
        document.getElementById('res-rank-txt').innerText = rMap[userData['rank']];
        
        document.getElementById('res-style').innerText = userData['sales_style'] || "Balanced";
        document.getElementById('res-specialty').innerText = userData['portfolio'] || "General";

        let current = 0;
        const timer = setInterval(() => {
            current += Math.ceil(final / 30);
            if(current >= final) { current = final; clearInterval(timer); }
            document.getElementById('finalPrice').innerText = current.toLocaleString();
        }, 30);
        document.getElementById('finalPct').innerText = pct;
        
        document.getElementById('res-prod').innerText = userData['premium'] >= 50 ? "A" : "B";
        document.getElementById('res-qual').innerText = userData['p13'] >= 90 ? "A+" : "B";
        document.getElementById('res-honor').innerText = userData['mdrt'] > 0 ? "YES" : "NO";
        
        document.getElementById('aiAdvice').innerText = "이 선수는 탁월한 역량과 잠재력을 보유하고 있습니다. 제시된 조건(Needs)을 충족한다면 팀의 성과를 극대화할 것입니다. 영입 1순위 대상입니다.";
    }

    function shareLink() { alert("리포트 주소가 복사되었습니다."); }
</script>

</body>
</html>


